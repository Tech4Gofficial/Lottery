<!DOCTYPE html>
<html>
<head>
<title>Color Bet</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="card">
<h2>ðŸŽ¨ Color Bet</h2>
<p>Balance: â‚¹<span id="bal">0</span></p>

<input type="number" id="bet" placeholder="Bet Amount" value="10"><br>
<button class="red" onclick="play('red')">Red 2x</button>
<button class="green" onclick="play('green')">Green 2x</button>
<button class="violet" onclick="play('violet')">Violet 5x</button>

<p id="res"></p>
<a href="games.html">â¬… Back to Games</a><br><br>
<button onclick="logout()">Logout</button>
</div>

<script src="firebase.js"></script>
<script>
let uid, gameActive=false;

firebase.auth().onAuthStateChanged(user=>{
  if(!user){location.href="index.html"; return;}
  uid=user.uid;
  firebase.database().ref("users/"+uid+"/balance")
    .on("value", snap => bal.innerText = snap.val());
});

function play(choice){
  if(gameActive) return alert("Finish current round first!");
  gameActive=true;
  let betAmt = Number(bet.value);
  if(betAmt<=0) return alert("Enter a valid bet");
  firebase.database().ref("users/"+uid+"/balance").once("value").then(snap=>{
    let bal=snap.val();
    if(bal<betAmt){gameActive=false; return alert("Low balance");}

    let colors=["red","green","violet","red","green"];
    let result=colors[Math.floor(Math.random()*5)];
    res.classList.add("flash");

    let multiplier=(choice==="violet")?5:2;
    if(choice===result){
      let win=betAmt*multiplier;
      firebase.database().ref("users/"+uid+"/balance").set(bal+win);
      res.innerText="ðŸŽ‰ WIN "+result+" â‚¹"+win;
    } else {
      firebase.database().ref("users/"+uid+"/balance").set(bal-betAmt);
      res.innerText="âŒ LOST "+result+" â‚¹"+betAmt;
    }
    gameActive=false;
  });
}

function logout(){
  firebase.auth().signOut();
  location.href="index.html";
}
</script>
</body>
</html>
