<!DOCTYPE html>
<html>
<head>
<title>Aviator</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="card">
<h2>‚úàÔ∏è Aviator</h2>
<p class="balance">Balance ‚Çπ<span id="bal">0</span></p>

<input id="bet" type="number" placeholder="Bet Amount"><br>
<button onclick="start()">Start</button>
<button onclick="cashout()">Cashout</button>

<div id="multi">1.00x</div>
<p id="msg"></p>

<a href="games.html">‚¨Ö Back</a>
</div>

<script src="firebase.js"></script>
<script>
let uid,m=1,betAmt=0,int,crashed=false;

firebase.auth().onAuthStateChanged(u=>{
 uid=u.uid;
 firebase.database().ref("users/"+uid+"/balance")
 .on("value",s=>bal.innerText=s.val());
});

function start(){
 betAmt=Number(bet.value);
 m=1;crashed=false;
 msg.innerText="‚úàÔ∏è Flying...";
 clearInterval(int);
 int=setInterval(()=>{
  m+=0.05;
  multi.innerText=m.toFixed(2)+"x";
  if(Math.random()<0.03) crash();
 },100);
}

function cashout(){
 if(crashed)return;
 let win=Math.floor(betAmt*m);
 update(win);
 msg.innerText="üí∞ Won ‚Çπ"+win;
 clearInterval(int);
}

function crash(){
 crashed=true;
 msg.innerText="üí• Crashed!";
 update(-betAmt);
 clearInterval(int);
}

function update(a){
 let r=firebase.database().ref("users/"+uid+"/balance");
 r.once("value",s=>r.set(s.val()+a));
}
</script>

</body>
</html>
