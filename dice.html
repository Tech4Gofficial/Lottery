<!DOCTYPE html>
<html>
<head>
  <title>Dice Game</title>
</head>
<body>

<h2>ğŸ² Dice Game</h2>
<p>Win if dice â‰¥ 4</p>

<input id="bet" type="number" placeholder="Bet amount"><br><br>
<button onclick="play()">Roll Dice</button>

<p id="res"></p>
<a href="games.html">â¬… Back</a>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="firebase.js"></script>

<script>
function play(){
  let betAmt = Number(bet.value);
  if(betAmt <= 0) return alert("Invalid bet");

  firebase.auth().onAuthStateChanged(user => {
    let ref = firebase.database().ref("users/"+user.uid+"/balance");

    ref.once("value", snap => {
      let bal = snap.val();
      if(bal < betAmt) return alert("Not enough balance");

      let dice = Math.floor(Math.random()*6)+1;

      if(dice >= 4){
        ref.set(bal + betAmt);
        res.innerText = "ğŸ‰ Dice: "+dice+" You WON!";
      } else {
        ref.set(bal - betAmt);
        res.innerText = "âŒ Dice: "+dice+" You LOST!";
      }
    });
  });
}
</script>

</body>
</html>
