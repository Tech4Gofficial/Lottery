<!DOCTYPE html>
<html>
<head>
  <title>Coin Flip</title>
</head>
<body>

<h2>ðŸª™ Coin Flip</h2>

<input id="bet" type="number" placeholder="Bet amount"><br><br>
<button onclick="flip()">Flip Coin</button>

<p id="out"></p>
<a href="games.html">â¬… Back</a>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="firebase.js"></script>

<script>
function flip(){
  let betAmt = Number(bet.value);
  if(betAmt <= 0) return alert("Invalid bet");

  firebase.auth().onAuthStateChanged(user => {
    let ref = firebase.database().ref("users/"+user.uid+"/balance");

    ref.once("value", snap => {
      let bal = snap.val();
      if(bal < betAmt) return alert("Low balance");

      let win = Math.random() < 0.5;
      if(win){
        ref.set(bal + betAmt);
        out.innerText = "ðŸŽ‰ You WON!";
      } else {
        ref.set(bal - betAmt);
        out.innerText = "âŒ You LOST!";
      }
    });
  });
}
</script>

</body>
</html>
